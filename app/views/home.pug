extends layout

block pageBody
  .home
    if user
      .container
        if (user.role == "Employee")
          .col-md-6.home-left-col
            h1(style="margin-top:0;") Welcome to Performify 
              span.user-name(style="color: gray; text-transform: capitalize; ") #{user.name}
            a(class='button btn btn-primary btn-login',  href='/users/'+user._id) View Profile
          .col-md-6.home-right-col
            p Charts and stuff will go here
              .img-border(style="border: 1px solid black; height:500px;")
        else if (user.role == "Management")
          .col-md-6.home-left-col
            h1(style="margin-top:0;") Welcome to Performify 
              span.user-name(style="color: gray; text-transform: capitalize; ") #{user.name}
            a(class='button btn btn-primary btn-login',  href='/users/'+user._id) View Profile
          .col-md-6.home-right-col
            p Charts and stuff will go here
              .img-border(style="border: 1px solid black; height:500px;")
        else if (user.role == "Senior Management")
          .col-md-6.home-left-col
            h1(style="margin-top:0;") Welcome to Performify 
              span.user-name(style="color: gray; text-transform: capitalize; ") #{user.name}
            a(class='button btn btn-primary btn-login',  href='/users/'+user._id) View Profile
          .col-md-6.home-right-col
            p Charts and stuff will go here
              .img-border(style="border: 1px solid black; height:500px;")
        else if (user.role == "Administrator")
          .col-md-6.home-left-col
            h1(style="margin-top:0;") Welcome to Performify 
              span.user-name(style="color: gray; text-transform: capitalize; ") #{user.name}
            a(class='button btn btn-primary btn-login',  href='/users/'+user._id) View Profile
          .col-md-6.home-right-col
            .gen-chart.center.float-none
              canvas#myChart(width="250" height="250")
    else
      .col-md-6.center.float-none
        h1 Welcome to Performify
        h2.text-center Please Login
        .btn-hold
          .btn-inner
            a(class='button btn btn-default btn-success btn-login', style="width: 30%; margin-left: 35%;" href='/users/login') Login
              i.fas.fa-sign-in-alt(style="margin-left:10px;")
    script.
      $.get('http://localhost:3333/chartsEndpoints/listUsersGen', {}, function(data){
        console.log(data);
        var g = data;
        let Female = 0;
        let Male = 0;
        let Transgender = 0;
        let Other = 0
        
        for (var i = 0; i < g.length; i++) {
          if (g[i].gender === 'Female') {
            Female += 1;
          }
          else if (g[i].gender === 'Male') {
            Male += 1;
          }
          else if (g[i].gender === 'Transgender') {
            Transgender += 1;
          }
          else {
            Other+= 1;
          }
        }
        let genderLabels = ['Male', 'Female', 'Trangender' , 'Other'];
        var ctx = document.getElementById("myChart").getContext('2d');
        var myChart = new Chart(ctx, {
          type: 'doughnut',
          data: {
              labels: genderLabels,
              datasets: [{
                  label: '# of Votes',
                  data:[Male , Female , Transgender , Other],
                  backgroundColor: [
                      //- 'rgba(255, 99, 132, 0.2)',
                      //- 'rgba(54, 162, 235, 0.2)',
                      'rgba(255, 206, 86, 0.2)',
                      'rgba(75, 192, 192, 0.2)',
                      'rgba(153, 102, 255, 0.2)',
                      'rgba(255, 159, 64, 0.2)'
                  ],
                  borderColor: [
                      //- 'rgba(255,99,132,1)',
                      //- 'rgba(54, 162, 235, 1)',
                      'rgba(255, 206, 86, 1)',
                      'rgba(75, 192, 192, 1)',
                      'rgba(153, 102, 255, 1)',
                      'rgba(255, 159, 64, 1)'
                  ],
                  borderWidth: 0
              }]
          },
          options: {
            responsive: true,
            title: {
              display: true,
              position: "top",
              text: "Gender Ratio",
              fontSize: 20,
              fontColor: "#111"
            },
            legend: {
              display: true,
              position: "bottom",
              labels: {
                fontColor: "#333",
                fontSize: 16
              }
            }
          }
        });
      });


